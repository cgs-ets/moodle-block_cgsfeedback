{"version":3,"file":"control.min.js","sources":["../src/control.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Provides the block_cgsfeedback/control module\n *\n * @package   block_cgsfeedback\n * @category  output\n * @copyright 2023 onwards Veronica Bermegui\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module block_cgsfeedback/control\n */\ndefine(['core/url', 'core/log'],\n    function (URL, Log) {\n    'use strict';\n\n    /**\n     * Initializes the block controls.\n     */\n    function init(instanceid) {\n        Log.debug('block_cgsfeedback/control: initializing controls of the cgsfeedback block');\n\n        var section = document.getElementById(`inst${instanceid}`)\n\n        if (section == null) {\n            Log.debug('block_cgsfeedback/control: section not found!');\n            return;\n        }\n\n        // Change the images URLS to be picked up the parentview plugin\n        encodeURL();\n        //\n        const expandIcon = document.querySelectorAll('.cgsfeedback-expand-icon');\n        expandIcon.forEach(icon => icon.addEventListener('click', expandTable));\n\n        const collapseIcon = document.querySelectorAll('.cgsfeedback-collapse-icon');\n        collapseIcon.forEach(icon => icon.addEventListener('click', collapseTable));\n\n        // Show table\n        function expandTable(e) {\n            console.log(\"expandTable\");\n            console.log(e.target.getAttribute('data-courseid'));\n            courseid = e.target.getAttribute('data-courseid');\n            const table = document.getElementById(`cgsfeedback-activities-container-${courseid}`);\n            console.log(table);\n            table.removeAttribute('hidden'); // Show table\n            // Hide expand icon\n            document.querySelector(`.cgsfeedback-expand-icon[data-courseid=\"${courseid}\"]`).setAttribute('hidden', true);\n            // Show collapse icon\n            document.querySelector(`.cgsfeedback-collapse-icon[data-courseid=\"${courseid}\"]`).removeAttribute('hidden');\n\n\n        }\n\n        // Hide table\n        function collapseTable(e) {\n            console.log(\"collapseTable\");\n            console.log(e.target.getAttribute('data-courseid'));\n            courseid = e.target.getAttribute('data-courseid');\n            const table = document.getElementById(`cgsfeedback-activities-container-${courseid}`);\n            table.setAttribute('hidden', true); // Hide table\n            document.querySelector(`.cgsfeedback-collapse-icon[data-courseid=\"${courseid}\"]`).setAttribute('hidden', true);\n            // Show collapse icon\n            document.querySelector(`.cgsfeedback-expand-icon[data-courseid=\"${courseid}\"]`).removeAttribute('hidden');\n        }\n\n        function encodeURL() {\n            const images = document.querySelectorAll(\"section#inst32  img\");\n\n            images.forEach(image => {\n                const urlEncoded = encodeURIComponent(image.getAttribute('src'));\n                console.log(urlEncoded);\n                const userid = document.querySelector('.cgsfeedback-course-container').getAttribute('data-userid');\n                const newURL = URL.relativeUrl('/local/parentview/get.php', {\n                    addr: urlEncoded,\n                    user: userid\n                });\n\n                image.setAttribute('src', newURL);\n\n            })\n\n        }\n\n\n    }\n\n    return {\n        init: init\n    };\n});"],"names":["define","URL","Log","init","instanceid","expandTable","e","console","log","target","getAttribute","courseid","table","document","getElementById","removeAttribute","querySelector","setAttribute","collapseTable","debug","querySelectorAll","forEach","image","urlEncoded","encodeURIComponent","userid","newURL","relativeUrl","addr","user","icon","addEventListener"],"mappings":";;;;;;;;AA2BAA,mCAAO,CAAC,WAAY,aAChB,SAAUC,IAAKC,WA0ER,CACHC,cArEUC,qBAoBDC,YAAYC,GACjBC,QAAQC,IAAI,eACZD,QAAQC,IAAIF,EAAEG,OAAOC,aAAa,kBAClCC,SAAWL,EAAEG,OAAOC,aAAa,qBAC3BE,MAAQC,SAASC,0DAAmDH,WAC1EJ,QAAQC,IAAII,OACZA,MAAMG,gBAAgB,UAEtBF,SAASG,gEAAyDL,gBAAcM,aAAa,UAAU,GAEvGJ,SAASG,kEAA2DL,gBAAcI,gBAAgB,mBAM7FG,cAAcZ,GACnBC,QAAQC,IAAI,iBACZD,QAAQC,IAAIF,EAAEG,OAAOC,aAAa,kBAClCC,SAAWL,EAAEG,OAAOC,aAAa,iBACnBG,SAASC,0DAAmDH,WACpEM,aAAa,UAAU,GAC7BJ,SAASG,kEAA2DL,gBAAcM,aAAa,UAAU,GAEzGJ,SAASG,gEAAyDL,gBAAcI,gBAAgB,UA3CpGb,IAAIiB,MAAM,6EAIK,MAFDN,SAASC,6BAAsBV,cA6C1BS,SAASO,iBAAiB,uBAElCC,SAAQ,SAAAC,WACLC,WAAaC,mBAAmBF,MAAMZ,aAAa,QACzDH,QAAQC,IAAIe,gBACNE,OAASZ,SAASG,cAAc,iCAAiCN,aAAa,eAC9EgB,OAASzB,IAAI0B,YAAY,4BAA6B,CACxDC,KAAML,WACNM,KAAMJ,SAGVH,MAAML,aAAa,MAAOS,WA9Cfb,SAASO,iBAAiB,4BAClCC,SAAQ,SAAAS,aAAQA,KAAKC,iBAAiB,QAAS1B,gBAErCQ,SAASO,iBAAiB,8BAClCC,SAAQ,SAAAS,aAAQA,KAAKC,iBAAiB,QAASb,mBAXxDhB,IAAIiB,MAAM"}